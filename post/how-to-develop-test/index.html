<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    Elvis Zhang
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="Elvis">
<meta name="description" content="The easy way or the right way!">
<meta name="keywords" content="Dead">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://blog.shunzi.tech/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
        
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                <!--点击特效-->
                <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/love.min.js"></script>
                
                    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic@latest/assets/media/script/APlayer.min.js"></script>
                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
                    
                        <!--CDN样式-->
                        <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
                                <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143818020-1"></script>
                                <script>
                                    window.dataLayer = window.dataLayer || [];

                                    function gtag() {
                                        dataLayer.push(arguments);
                                    }
                                    gtag('js', new Date());
                                    gtag('config', 'UA-143818020-1');
                                </script>
                                
                                    <script type="text/javascript">
                                        var _hmt = _hmt || [];
                                        (function() {
                                            var hm = document.createElement("script");
                                            hm.src = "https://hm.baidu.com/hm.js?225d600be3e5bb9ae41b903854555ba8";
                                            var s = document.getElementsByTagName("script")[0];
                                            s.parentNode.insertBefore(hm, s);
                                        })();
                                    </script>
                                    
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://blog.shunzi.tech">
                    Elvis Zhang
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/posts">
                        博客
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tag/diary">
                        随笔
                    </a>
                    
                    <a class="menu-item" href="https://blog.shunzi.tech/post/tools">
                        导航
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1629772212598" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://blog.shunzi.tech">
                            Elvis Zhang
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1629772212598" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/posts">
                            博客
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tag/diary">
                            随笔
                        </a>
                        
                        <a class="menu-item" href="https://blog.shunzi.tech/post/tools">
                            导航
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                教你写测试
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            Elvis Zhang
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2019-05-24</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">12.3
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">2317</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://blog.shunzi.tech/tag/Test/">测试</a>
                                
                                <a href="https://blog.shunzi.tech/tag/Product-Standard/">Product Standard</a>
                                
                            </span>
                                            
                                                阅读量:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                            <img class="post-feature-image" src="https://thejournal.com/~/media/EDU/THEJournal/Images/2015/02/20150224test644.jpg" alt="">
                          
                        <div class="post-content">
                            <blockquote>
<ul>
<li>测试开发</li>
<li>结合实际例子介绍相关测试框架的使用</li>
<li>Findbugs, Fortify，SonarQube，PMD也会做简单介绍</li>
</ul>
</blockquote>
<!-- more --> 
<p><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-unit-test-ut">单元测试 Unit Test (UT)</a><br>
*
<ul>
<li><a href="#junit45">JUnit4/5</a></li>
<li><a href="#mockito">Mockito</a></li>
<li><a href="#how">How</a>
<ul>
<li><a href="#servicedao-unit-test">service/dao unit test</a></li>
</ul>
</li>
<li><a href="#springtest">SpringTest</a>
<ul>
<li><a href="#mockmvc-unit-test">mockMvc unit test</a></li>
</ul>
</li>
<li><a href="#powermock">PowerMock</a>
<ul>
<li><a href="#how-to-use">How to use:</a></li>
<li><a href="#caution">Caution:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95-integration-test-it">集成测试 Integration Test (IT)</a><br>
*
<ul>
<li><a href="#spring-integration-test">Spring Integration Test</a></li>
<li><a href="#prepare">Prepare:</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B">代码实例：</a></li>
</ul>
</li>
<li><a href="#%E7%B3%BB%E7%BB%9F%E6%B5%8B%E8%AF%95-system-test-st">系统测试 System Test (ST)</a>
<ul>
<li><a href="#jmeter">JMeter</a>
<ul>
<li><a href="#download-and-launch">Download and Launch</a></li>
<li><a href="#how-to-use-jmeter">How to use JMeter</a></li>
<li><a href="#example-code">Example Code</a></li>
<li><a href="#head-first">Head First</a>
<ul>
<li><a href="#step-1-create-thread-group">Step 1. Create Thread Group</a></li>
<li><a href="#step-2-define-some-common-variables">Step 2. Define some common variables</a></li>
<li><a href="#step-3-new-http-request">Step 3. New Http Request</a></li>
<li><a href="#step-4-new-assertersjson-assertion-response-assertion-etc">Step 4. New Asserters.(JSON Assertion, Response Assertion etc.)</a></li>
<li><a href="#step-5-processor-prepost">Step 5. Processor (Pre/Post)</a></li>
<li><a href="#step-6-result-tree">Step 6. Result Tree</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95auto-ui-test">自动化测试（Auto UI Test）</a>
<ul>
<li><a href="#katalon-studio">Katalon Studio</a></li>
<li><a href="#groovy-based-on-java">Groovy (Based on Java)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</p>
<hr>
<ul>
<li>测试的重要性不做过多介绍。简单介绍一种 <code>TDD(Test Driven Development)</code>的模式。</li>
<li><code>TDD</code> 旨在通过先编写相关的测试类和测试代码来驱动实际业务代码的开发。对于测试代码，业务代码更多的像是在承担一个黑盒的角色，而测试代码只需要关注输入输出，从逻辑意义上保证输入输出和我们预期的结果相对应则是业务代码需要去保证实现的。</li>
<li><code>TDD</code>具体实现此处仅提供一种思路。测试类编写完成之后，使其一直运行在本地搭建的服务器上，编写相关业务代码完成后，通过在运行测试类的服务器上指定输入参数，通过测试代码的断言实时反应业务代码的正确性。</li>
</ul>
<hr>
<h2 id="单元测试-unit-test-ut">单元测试 Unit Test (UT)</h2>
<ul>
<li>应用场景：从代码层面去测试相关代码的正确性，是否符合预期的结果。此处不涉及和其他软件或者应用交互的过程，仅仅针对代码的逻辑处理。常常用于寻找程序中可能出现的异常以及代码逻辑的正确性。</li>
<li>工具：JUnit4/5, Mockito, SpringTest, PowerMock</li>
</ul>
<h4 id="junit45">JUnit4/5</h4>
<ul>
<li><a href="https://junit.org/junit5/docs/current/user-guide/">JUnit5 User Guide</a></li>
<li>JUnit 主要是利用 Java 注解构建了一套单元测试的相关体系，同时提供了很多工具方便单元测试的编写。具体注解的使用，参照官方文档。</li>
</ul>
<h4 id="mockito">Mockito</h4>
<ul>
<li><a href="https://site.mockito.org/">官方主页</a></li>
</ul>
<h4 id="how">How</h4>
<h5 id="servicedao-unit-test">service/dao unit test</h5>
<ul>
<li>Before: You must init mockito in @Before of JUnit.</li>
</ul>
<pre><code class="language-Java">@Before
public void setUp() throws Exception
{
    MockitoAnnotations.initMocks(this);
}
</code></pre>
<ul>
<li>Annotation: <code>@Mock</code> <code>@InjectMocks</code>
<ul>
<li><code>@Mock</code> : This annotation is used to mock an object. It seems like new Object() to give memory for this pointer.</li>
<li><code>@InjectMocks</code> : This annotation is used to inject other mocks objects to the annotation decorated obejct.</li>
</ul>
</li>
<li>Method: <code>when()</code> <code>verify()</code> <code>any()</code>
<ul>
<li><code>when()</code> : This method is used to listen the emthod if be invoked.And when this method is invoked, you can give return value for this method. So you do not need to care the specific implemention of this method.</li>
<li><code>verify()</code>: It is used to verify if this method be invoked and you also can verify the invoke times as params of this method.</li>
<li><code>any()</code>: It is used for mock objects. You can only give the type of the param without specific value. It is common used in <code>when</code> method to instead of specific params.</li>
</ul>
</li>
<li>Example:</li>
</ul>
<pre><code class="language-Java">package tech.shunzi.testdev.service;

import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import tech.shunzi.testdev.model.User;
import tech.shunzi.testdev.model.dto.UserDto;
import tech.shunzi.testdev.repo.UserRepository;
import tech.shunzi.testdev.service.impl.UserServiceImpl;

import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

public class UserServiceImplTest {

    @Mock
    private UserRepository userRepository;

    @InjectMocks
    private UserServiceImpl userService;

    @Before
    public void setUp() throws Exception
    {
        MockitoAnnotations.initMocks(this);
    }

    @Test
    public void testGetAllUsers() {

        // Prepare data
        List&lt;User&gt; userList = new ArrayList&lt;&gt;();
        User user = new User();
        user.setDesc(&quot;DESC&quot;);
        user.setId(1111);
        user.setName(&quot;Shunzi&quot;);
        userList.add(user);

        List&lt;UserDto&gt; dtos = new ArrayList&lt;&gt;();
        UserDto dto = new UserDto();
        dto.setGroupNo(1);
        dto.setName(user.getName());
        dto.setId(user.getId());
        dto.setIntroduction(&quot;Hello, I am Shunzi. And my id is 1111. DESC&quot;);
        dtos.add(dto);

        // When
        when(userRepository.findAll()).thenReturn(userList);

        // Act
        List&lt;UserDto&gt; users = userService.findAllUsers();

        // Verify
        verify(userRepository).findAll();

        // Assert
        // override method equals() in UserDto class
        assertEquals(dtos, users);
    }
    
    @Test
    public void testGetUserById() {

        // prepare data
        int id = 1;
        User user = new User();
        user.setId(id);
        user.setName(&quot;shunzi&quot;);
        user.setDesc(&quot;desc&quot;);

        // when
        // anyInt() will match all params whose type is int
        when(userRepository.findById(anyInt())).thenReturn(user);

        // Act
        UserDto userDto = userService.findSingleUser(id);

        // verify
        verify(userRepository).findById(anyInt());

        // assert
        assertEquals(id, userDto.getId());
    }
}
</code></pre>
<h4 id="springtest">SpringTest</h4>
<h5 id="mockmvc-unit-test">mockMvc unit test</h5>
<ul>
<li>Before: You must init the MockMvc and bind it to controller class.</li>
</ul>
<pre><code class="language-Java">private HelloController helloController;
private MockMvc mockMvc;

@Before
public void setUp() throws Exception
{
    MockitoAnnotations.initMocks(this);
    //use controller to build mock mvc.
    mockMvc = MockMvcBuilders.standaloneSetup(helloController).build();
}
</code></pre>
<ul>
<li>Class : <code>MockMvc</code></li>
<li>Method : <code>perform()</code>,<code>get() post() put() delete()</code>, <code>contentType()</code>, <code>param()</code>, <code>andExpect()</code>,<code>status()</code>,<code>isOk()</code>,<code>andReturn()</code>,<code>getResponse()</code>, <code>getContentAsString()</code></li>
<li>There are some use cases of methods.</li>
</ul>
<pre><code class="language-Java">// GET
String responseStr = mockMvc.perform(get(requestUrl).contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk()).andReturn().getResponse().getContentAsString();
//POST form                
String responseData = mockMvc.perform(post(requestURI).param(&quot;tenantId&quot;, &quot;dev&quot;))
                .andExpect(status().isOk()).andReturn().getResponse().getContentAsString();

//PUT
String responseData = mockMvc.perform(put(requestURI).param(&quot;tenantId&quot;, &quot;dev&quot;)).
                andExpect(status().isOk()).andReturn().getResponse().getContentAsString();

//DELETE
String data = mockMvc .perform(delete(requestURI).contentType(MediaType.APPLICATION_JSON).content(&quot;the params with json format&quot;)
                .andExpect(status().isOk()).andReturn().getResponse().getContentAsString();
</code></pre>
<ul>
<li>Example:</li>
</ul>
<pre><code class="language-Java">package tech.shunzi.testdev.controller;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import org.springframework.http.MediaType;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import tech.shunzi.testdev.model.dto.UserDto;
import tech.shunzi.testdev.service.impl.UserServiceImpl;

import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

public class UserControllerTest {

    private MockMvc mockMvc;

    @Mock
    private UserServiceImpl userService;

    @InjectMocks
    private UserController userController;

    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
        mockMvc = MockMvcBuilders.standaloneSetup(userController).build();
    }

    @Test
    public void testFindAll() throws Exception {
        // Prepare data
        String requestUrl = &quot;/users&quot;;
        List&lt;UserDto&gt; userDtoList = new ArrayList&lt;&gt;();
        UserDto userDto = new UserDto();
        userDto.setName(&quot;shunzi&quot;);
        userDtoList.add(userDto);

        ObjectMapper mapper = new ObjectMapper();
        String expectedValue = mapper.writeValueAsString(userDtoList);

        // When
        when(userService.findAllUsers()).thenReturn(userDtoList);

        // Act
        String responseStr = mockMvc.perform(get(requestUrl).accept(MediaType.APPLICATION_JSON_UTF8)).andExpect(status().isOk()).andReturn().getResponse().getContentAsString();

        // Verify
        verify(userService).findAllUsers();

        // Assert
        assertEquals(expectedValue, responseStr);
    }
}

</code></pre>
<h4 id="powermock">PowerMock</h4>
<ul>
<li>We usually use PowerrMock to mock static method.<code>public static returnValue methodName(T param)</code></li>
</ul>
<h5 id="how-to-use">How to use:</h5>
<ul>
<li>Prepare:
<ul>
<li>Use annotation <code>@PrepareForTest(IncludeStaticMethodClass.class)</code> to annotate unit test class.</li>
<li>Use annotation <code>@RunWith(PowerMockRunner.class)</code> to annotate unit test class.</li>
</ul>
</li>
<li>Use:
<ul>
<li>method:
<ul>
<li><code>PowerMockito.mockStatic()</code>  // mock static class</li>
<li><code>PowerMocckito.when()</code> // mock static method invoke</li>
</ul>
</li>
</ul>
</li>
<li>Example:</li>
</ul>
<pre><code class="language-Java">@PrepareForTest(ObjectFieldEmptyUtil.class)
@RunWith(PowerMockRunner.class)
public class UserServiceImplTest {

    @Mock
    private UserRepository userRepository;

    @InjectMocks
    private UserServiceImpl userService;

    @Before
    public void setUp() throws Exception {
        MockitoAnnotations.initMocks(this);
    }
    
    @Test(expected = RuntimeException.class)
    public void testSaveUser() {

        // Prepare data
        UserDto user = new UserDto();
        user.setName(&quot;shunzi&quot;);
        user.setIntroduction(&quot;intro&quot;);
        User model = new User();
        model.setDesc(&quot;intro&quot;);
        model.setName(&quot;shunzi&quot;);
        model.setId(1);
        List&lt;String&gt; stringList = new ArrayList&lt;&gt;();
        stringList.add(&quot;name&quot;);

        PowerMockito.mockStatic(ObjectFieldEmptyUtil.class);
        PowerMockito.when(ObjectFieldEmptyUtil.findEmptyFields(anyObject(), anyList())).thenReturn(stringList);

        // Act
        UserDto userDto = userService.saveUser(user);

        // Assert
        assertEquals(&quot;shunzi&quot;, userDto.getName());
    }
}
</code></pre>
<h5 id="caution">Caution:</h5>
<ul>
<li>Please refer <a href="https://github.com/powermock/powermock">PowerMock Github Repo</a> version issues.</li>
<li>It must match <code>Mockito</code> version</li>
</ul>
<h2 id="集成测试-integration-test-it">集成测试 Integration Test (IT)</h2>
<ul>
<li>应用场景：比起单元测试，集成测试加载了相关的环境变量和上下文，能够对整个Spring上下文里的代码进行测试。而在单元测试中是通过<code>@Mock</code>的方式进行注入的，在集成测试的场景下可以直接 <code>@Autowire</code> 相关对象，同时能够和<code>DB</code>进行交互，也能对相关接口进行实际场景的测试。</li>
<li>工具: JUnit4/5, Spring Test, SpringBoot Test.</li>
</ul>
<h4 id="spring-integration-test">Spring Integration Test</h4>
<ul>
<li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-testing.html">官方文档</a></li>
</ul>
<h4 id="prepare">Prepare:</h4>
<ul>
<li>添加 application-test.xml 配置文件，为专门的测试系统进行配置。</li>
<li>便于指定 <code>ActiveProfiles(&quot;test&quot;)</code></li>
</ul>
<h4 id="代码实例">代码实例：</h4>
<ul>
<li>BaseIntegrationTest</li>
</ul>
<pre><code class="language-Java">package tech.shunzi.testdev.integration.test;

import org.junit.Before;
import org.junit.Rule;
import org.junit.contrib.java.lang.system.EnvironmentVariables;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.MOCK)
@AutoConfigureMockMvc
@ActiveProfiles(&quot;test&quot;)
public abstract class BaseIntegrationTest {

    @Autowired
    protected MockMvc mockMvc;

    @Rule
    public final EnvironmentVariables environmentVariables = new EnvironmentVariables();

    @Before
    public void setUpEnv()
    {
        environmentVariables.set(&quot;key&quot;,&quot;value&quot;);
    }
}
</code></pre>
<ul>
<li>其余具体的 <code>Integration Test Class</code>均可继承 <code>BaseIntegrationTest</code></li>
</ul>
<pre><code class="language-Java">package tech.shunzi.testdev.integration.test;

import org.junit.Test;
import org.springframework.http.MediaType;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

public class UserControllerIntTest extends BaseIntegrationTest {

    @Test
    public void testFindAll() throws Exception {
        // Prepare data
        String requestUrl = &quot;/users&quot;;

        // Act
        String responseStr = mockMvc.perform(get(requestUrl).accept(MediaType.APPLICATION_JSON_UTF8)).andExpect(status().isOk()).andReturn().getResponse().getContentAsString();
        
        // Advise to use assert, sout in here is just to show query result from DB
        System.out.println(responseStr);
    }
}
</code></pre>
<ul>
<li>针对 Service 和 Dao 层可以不加载相关 Web 环境</li>
</ul>
<pre><code class="language-Java">package tech.shunzi.testdev.integration.test;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringRunner;
import tech.shunzi.testdev.service.UserService;

@RunWith(SpringRunner.class)
@SpringBootTest
@ActiveProfiles(&quot;test&quot;)
public class UserServiceTest {

    @Autowired
    private UserService userService;

    @Test
    public void testFindAll() {
        System.out.println(userService.findAllUsers());
    }
}

</code></pre>
<h2 id="系统测试-system-test-st">系统测试 System Test (ST)</h2>
<ul>
<li>应用场景：系统测试相比于其他之前的测试，是从系统层面出发，对整个功能或者整套流程进行测试。是一种黑盒测试。也常常用来测试相关功能模块的性能。</li>
<li>工具： JMeter</li>
</ul>
<h3 id="jmeter">JMeter</h3>
<ul>
<li><a href="https://jmeter.apache.org/">官方主页</a></li>
</ul>
<h4 id="download-and-launch">Download and Launch</h4>
<ul>
<li>download JMeter: https://jmeter.apache.org/download_jmeter.cgi and select &quot;apache-jmeter-4.0.zip&quot;</li>
<li>unzip the jmeter to your own folder</li>
<li>go to your jmeter folder: [your folder]\apache-jmeter-4.0\bin and run jmeter.bat or run ApacheJMeter.jar</li>
</ul>
<h4 id="how-to-use-jmeter">How to use JMeter</h4>
<ul>
<li><a href="https://video.sap.com/media/t/1_4nj2lh3u/39197781">Short video</a></li>
</ul>
<h4 id="example-code">Example Code</h4>
<ul>
<li><a href="https://github.com/zjs1224522500/dev-test/blob/master/src/main/resources/jmx/Thread%20Group-%20User%20Function.jmx">Github JMX</a></li>
</ul>
<h4 id="head-first">Head First</h4>
<ul>
<li>Aim: Test Create User function</li>
<li>Procedure:
<ul>
<li>Query All User. Verify init data</li>
<li>Create User And Verify Response Dara</li>
<li>Query All User. Verify new added data</li>
</ul>
</li>
</ul>
<h5 id="step-1-create-thread-group">Step 1. Create Thread Group</h5>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/new%20thread%20group.png" alt="image" loading="lazy"></figure>
<h5 id="step-2-define-some-common-variables">Step 2. Define some common variables</h5>
<ul>
<li>You can define some common data. Such as host, port and even params etc.<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/new%20http%20request.png" alt="image" loading="lazy"></li>
</ul>
<h5 id="step-3-new-http-request">Step 3. New Http Request</h5>
<ul>
<li>Create Http Request Example<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/new%20http%20request.png" alt="image" loading="lazy"></li>
<li>Http Request Main Param<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/Request%20Body%20Param.png" alt="image" loading="lazy"></li>
<li>You can control the header attribute (key-value)<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/Header%20Attributes.png" alt="image" loading="lazy"></li>
<li>JSON Extractor: Extract json response data to variables<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/Header%20Attributes.png" alt="image" loading="lazy"></li>
</ul>
<h5 id="step-4-new-assertersjson-assertion-response-assertion-etc">Step 4. New Asserters.(JSON Assertion, Response Assertion etc.)</h5>
<ul>
<li>Assertion should be combined with Assertion Results.</li>
<li>JSON Assertion<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/JSON%20Assertion.png" alt="image" loading="lazy"></li>
<li>Response Assertion<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/Response%20Assertion.png" alt="image" loading="lazy"></li>
</ul>
<h5 id="step-5-processor-prepost">Step 5. Processor (Pre/Post)</h5>
<ul>
<li>BeanShell Post Processor<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/Bean%20shell%20processor.png" alt="image" loading="lazy"></li>
</ul>
<h5 id="step-6-result-tree">Step 6. Result Tree</h5>
<ul>
<li>Result tree shows all result of test http request.<br>
<img src="https://raw.githubusercontent.com/zjs1224522500/dev-test/master/src/main/resources/pic/result%20tree.png" alt="image" loading="lazy"></li>
</ul>
<h2 id="自动化测试auto-ui-test">自动化测试（Auto UI Test）</h2>
<ul>
<li>应用场景：为了减小人工测试过程中重复的工作量，通过编写相关脚本语言，实现模拟人为操作，进而对UI上的元素进行点击等操作，测试相关功能。除此以外，也可将部分固定流程的操作进行抽象，并绑定相关定时任务，实现对应的需求。</li>
<li>工具： Katalon Studio(Groovy)</li>
</ul>
<h3 id="katalon-studio">Katalon Studio</h3>
<ul>
<li><a href="https://www.katalon.com/">官方主页</a></li>
</ul>
<h3 id="groovy-based-on-java">Groovy (Based on Java)</h3>
<ul>
<li><a href="http://www.groovy-lang.org/">官方主页</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-unit-test-ut">单元测试 Unit Test (UT)</a><br>
*
<ul>
<li><a href="#junit45">JUnit4/5</a></li>
<li><a href="#mockito">Mockito</a></li>
<li><a href="#how">How</a>
<ul>
<li><a href="#servicedao-unit-test">service/dao unit test</a></li>
</ul>
</li>
<li><a href="#springtest">SpringTest</a>
<ul>
<li><a href="#mockmvc-unit-test">mockMvc unit test</a></li>
</ul>
</li>
<li><a href="#powermock">PowerMock</a>
<ul>
<li><a href="#how-to-use">How to use:</a></li>
<li><a href="#caution">Caution:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95-integration-test-it">集成测试 Integration Test (IT)</a><br>
*
<ul>
<li><a href="#spring-integration-test">Spring Integration Test</a></li>
<li><a href="#prepare">Prepare:</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E4%BE%8B">代码实例：</a></li>
</ul>
</li>
<li><a href="#%E7%B3%BB%E7%BB%9F%E6%B5%8B%E8%AF%95-system-test-st">系统测试 System Test (ST)</a>
<ul>
<li><a href="#jmeter">JMeter</a>
<ul>
<li><a href="#download-and-launch">Download and Launch</a></li>
<li><a href="#how-to-use-jmeter">How to use JMeter</a></li>
<li><a href="#example-code">Example Code</a></li>
<li><a href="#head-first">Head First</a>
<ul>
<li><a href="#step-1-create-thread-group">Step 1. Create Thread Group</a></li>
<li><a href="#step-2-define-some-common-variables">Step 2. Define some common variables</a></li>
<li><a href="#step-3-new-http-request">Step 3. New Http Request</a></li>
<li><a href="#step-4-new-assertersjson-assertion-response-assertion-etc">Step 4. New Asserters.(JSON Assertion, Response Assertion etc.)</a></li>
<li><a href="#step-5-processor-prepost">Step 5. Processor (Pre/Post)</a></li>
<li><a href="#step-6-result-tree">Step 6. Result Tree</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95auto-ui-test">自动化测试（Auto UI Test）</a>
<ul>
<li><a href="#katalon-studio">Katalon Studio</a></li>
<li><a href="#groovy-based-on-java">Groovy (Based on Java)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>Elvis Zhang</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://blog.shunzi.tech/post/how-to-develop-test/">https://blog.shunzi.tech/post/how-to-develop-test/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://blog.shunzi.tech/post/how-to-develop-test/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://blog.shunzi.tech/post/how-to-develop-test/&sharesource=qzone&title=教你写测试&pics=https://blog.shunzi.tech/images/avatar.png?v=1629772212598&summary=&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;测试开发&lt;/li&gt;
&lt;li&gt;结合实际例子介绍相关测试框架的使用&lt;/li&gt;
&lt;li&gt;Findbugs, Fortify，SonarQube，PMD也会做简单介绍&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
"><i class="fa fa-qq"></i></a>
                                                                    <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://blog.shunzi.tech/post/how-to-develop-test/&sharesource=weibo&title=教你写测试 + " - " + &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;测试开发&lt;/li&gt;
&lt;li&gt;结合实际例子介绍相关测试框架的使用&lt;/li&gt;
&lt;li&gt;Findbugs, Fortify，SonarQube，PMD也会做简单介绍&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&pic="https://blog.shunzi.tech/images/avatar.png?v=1629772212598 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://blog.shunzi.tech/tag/Test/">#
                    测试
                        </a>
                        
                        <a href="https://blog.shunzi.tech/tag/Product-Standard/">#
                    Product Standard
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://blog.shunzi.tech/post/rabbitmq/">
                                                                                            RabbitMQ
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://blog.shunzi.tech/post/spring-event/">
                                                                                                    Spring Event
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                <div class="post-wrap">
                
                                            
                                                <script type="application/javascript" src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
<div id="vlaine-comment"></div>
<script type="application/javascript">
    new Valine({
        el: '#vlaine-comment',
        appId: 'Pj5H1z0w7hJlLGJpGBh9NrCq-MdYXbMMI',
        appKey: 'LdR8vK5EaBfK87esF7tlbsXe',
        pageSize: 5,
        avatar: 'mp',
        placeholder: '来都来了，不妨评论一下',
        visitor: false,
        highlight: false,
        recordIP: false,
    })
</script>
                                                    
                                                </div>
            </div>
    </div>
    </div>
    </div>
    
    <div id="player"></div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
                            
                                <b id="hitokoto"></b><br>
                                
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        Elvis Zhang &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://github.com/" target="_blank">
                                                Github Pages
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.6
                </div>
                
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    

                    function LoadPlayer() {
                        var musicList = [];
                        
                        musicList.push({
                            name: 'See You Again (feat. Charlie Puth)',
                            url: 'https://link.jscdn.cn/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBbmlqSWg1RWM0TlZoSXhtUU9nLTk3R2g5cDVlblE.mp3',
                            artist: 'Charlie Puth',
                            cover: 'https://4.bp.blogspot.com/-tk-Dzg0cHNQ/WnxPiEImF8I/AAAAAAAAMbg/FisRjWssG3kMFGiMh1BE3j4U6QnI2O3rwCLcBGAs/s1600/wiz-khalifa-see-you-again.jpg',
                        });
                        
                        console.log(" MusicList: " + musicList);
                        
                        const ap = new APlayer({
                            container: document.getElementById('player'),
                            fixed: true,
                            audio: musicList
                        });
                        
                    }
                    LoadPlayer();
                    
                    
                    loadlive2d();
                    
                    
                    hitokoto();
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1629772212598);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>