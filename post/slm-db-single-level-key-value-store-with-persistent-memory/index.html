<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    Elvis Zhang
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="Elvis">
<meta name="description" content="The easy way or the right way!">
<meta name="keywords" content="Dead">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://blog.shunzi.tech/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
        
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                <!--点击特效-->
                <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/love.min.js"></script>
                
                        <!--CDN样式-->
                        <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
                                <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143818020-1"></script>
                                <script>
                                    window.dataLayer = window.dataLayer || [];

                                    function gtag() {
                                        dataLayer.push(arguments);
                                    }
                                    gtag('js', new Date());
                                    gtag('config', 'UA-143818020-1');
                                </script>
                                
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://blog.shunzi.tech">
                    Elvis Zhang
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        主页
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tag/diary">
                        随笔
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1623475546024" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://blog.shunzi.tech">
                            Elvis Zhang
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1623475546024" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            主页
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tag/diary">
                            随笔
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                SLM-DB Single-Level Key-Value Store with Persistent Memory
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            Elvis Zhang
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2019-10-27</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">16.4
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">4452</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://blog.shunzi.tech/tag/5uQUdLlSC/">Paper</a>
                                
                                <a href="https://blog.shunzi.tech/tag/3zCwFWPHxH/">存储</a>
                                
                            </span>
                                            
                                                阅读量:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                            <img class="post-feature-image" src="https://github.com/zjs1224522500/files-and-images/blob/master/blog/pic/Arch-SLM-DB.png?raw=true" alt="">
                          
                        <div class="post-content">
                            <blockquote>
<ul>
<li>FAST 2019 的文章《SLM-DB Single-Level Key-Value Store with Persistent Memory》</li>
<li>这篇论文主要在新型存储器件Persistent Memory上针对传统的 LSM 树进行了优化。</li>
<li>本篇论文用于课程论文阅读汇报，故在此总结便于演讲。同时学习 NVM 相关基础知识。</li>
</ul>
</blockquote>
<!--more-->
<h2 id="摘要">摘要</h2>
<ul>
<li>这篇 Paper 主要研究了如何利用新型的字节型寻址器件 PM 来提升 KV 存储系统的性能。提出了一种新型的 KV 存储系统的架构设计 SLM-DB。</li>
<li>SLM-DB 充分利用 B+ Tree 和 LSM Tree 的优势充分发挥 PM 的特性，实现了较高的读写性能，同时降低了写放大，实现了接近最优的读放大。</li>
</ul>
<h2 id="introduction">Introduction</h2>
<ul>
<li>两种传统的 KV 存储类型：一种是基于 B-Tree 的存储引擎，一种是基于 LSM 的存储引擎。</li>
</ul>
<h3 id="b-tree">B-Tree</h3>
<ul>
<li>特性：在读操作和范围查询操作方面表现较好，在写操作的性能方面表现较差，特别是针对大量的随机小写，并且由于需要动态地维护平衡结构往往就会有很严峻的写放大问题。</li>
<li>B-Tree 类型的 KV 存储更适用于 读密集型的工作负载。</li>
<li>实际的应用产品：KyotoCabinet</li>
</ul>
<h3 id="lsm-tree">LSM Tree</h3>
<ul>
<li>LSM-Tree 有较高的写性能，通过将相关 KV 缓冲在内存中并批量地将其顺序写入磁盘中。但该结构由于需要维护多层的结构来进行合并压缩归并排序等操作，导致了具有很严重的读写放大问题，在读性能方面表现较差</li>
<li>LSM Tree 类型的 KV 存储更适用于 写密集型的工作负载。</li>
<li>实际的应用产品：BigTable，LevelDB，RocksDB，Cassandra。</li>
</ul>
<h3 id="persistent-memory">Persistent Memory</h3>
<ul>
<li>一种新型的存储器件，具有与 DRAM 相当的读写性能，带宽相对 DRAM 较低，但也比 DRAM 拥有更大的容量，最重要的是具有持久性的相关功能</li>
</ul>
<h3 id="优化方式">优化方式</h3>
<h4 id="读优化">读优化</h4>
<ul>
<li>利用 PM 的特性维护 B+ Tree 作为索引，加速数据的检索</li>
</ul>
<h4 id="写优化">写优化</h4>
<ul>
<li>利用 LSM 的特性来进行 KV 的写入操作，使用 PM 进行缓冲写入，省略了 WAL 的写开销</li>
<li>采用单层的 LSM 结构来减小写放大问题带来的影响，但同时需要设计新的压缩算法来保证单层结构中的数据部分有序，从而保证范围查询的性能。</li>
</ul>
<h2 id="background-motivation">Background &amp; Motivation</h2>
<h3 id="leveldb-introduction">LevelDB Introduction</h3>
<h4 id="组成部分">组成部分</h4>
<ul>
<li><strong>Memory</strong>：使用传统的 DRAM 存储和操作 MemTable 和 Immutable Memtable</li>
<li><strong>Disk</strong>：使用磁盘存储和操作多级的 SSTables</li>
</ul>
<h4 id="核心机制">核心机制</h4>
<h5 id="写流程">写流程</h5>
<ul>
<li>写流程可以具体划分为插入和更新操作。当有记录要写入时，按照 Key 在 Memtable 中的对应的位置，判断该 Key 是否已经存在，如果存在则进行更新。不存在则相应地写入该 Key 和 Value。</li>
<li>Memtable 是内存中存数据的地方，这些数据按 Key值排序，为了快速查找，会有红黑树之类的数据结构作为索引。当 Memtable 大小到一定阈值，先状态改变，变成 Immutable Memtable，然后新建一个 Memtable，启动一个后台线程就把 Immutable Memtable 存到一个文件，这个文件就是一个SSTable，相应地将文件刷入磁盘。</li>
<li>随着 SSTable File的数量越来越多，触发对应的 Compaction 操作，将对应的 SSTable 文件进行合并，合并到新的数据层上。</li>
</ul>
<h5 id="读流程">读流程</h5>
<ul>
<li>首先在memtable中查找，没找到的话，再到 Immutable Memtable 上进行查找，还是没找到的话，再按时间顺序在SSTable文件中查找。当读数据的时候，如果某个记录不存在，需要读取所有的SSTable才能确定。所以一般每个SSTable文件生成的时候会带一个bloom filter，对这一点进行优化。</li>
</ul>
<h4 id="一致性保证">一致性保证</h4>
<ul>
<li>在内存中的写操作采用了 WAL 的机制来进行一致性的保证，统一地先进行日志写的操作，再进行实际的数据插入操作。</li>
<li>在磁盘上的数据的一致性保证，采用了 MANIFEST 日志进行保证，针对来自内存的刷会操作和压缩操作都会进行对应的日志记录，主要记录 LSM Tree的结构变化数据。</li>
</ul>
<h4 id="延申参考链接">延申参考链接</h4>
<ul>
<li><a href="https://juejin.im/post/5bbbf7615188255c59672125">[1] 掘金：看图轻松理解数据结构与算法系列(NoSQL存储-LSM树)</a></li>
<li><a href="https://juejin.im/post/5b1f69dee51d4506d25e31ea">[2] 掘金：一文带你了解 LSM Compaction</a></li>
</ul>
<h3 id="limitation-of-leveldb">Limitation of LevelDB</h3>
<ul>
<li>LevelDB 的几个核心问题：较低的读性能 和 严峻的读写放大问题</li>
</ul>
<h4 id="slow-read-operation">Slow Read Operation</h4>
<ul>
<li><strong>最少两次读块的操作</strong>：从 LevelDB 中的读流程中我们不难发现，针对在内存中未能命中的数据往往都意味着在磁盘上的每一个 Level 上都会有进行二分查找的操作，首先二分查找定位数据所在的文件 SSTable File；找到对应的文件以后，基于 SSTable File 中存储的数据索引再次进行二分查找，找到对应的数据块。<strong>一次读索引块，一次读数据块</strong></li>
<li><strong>如果数据块中不包含，则需要进入下一级重复该操作</strong></li>
<li>引入 <strong>Bloom Filter</strong>，一定程度上减小了读操作的开销。</li>
</ul>
<h4 id="high-write-and-read-amplification">High write and read amplification</h4>
<h5 id="write-amplification">Write Amplification</h5>
<ul>
<li>LSM 通过维护垂直的多级有序数据结构 SSTables 来保证顺序写，从而提高写的速度，但对应的也就引入了维护该结构的开销。</li>
<li>需要在不同的层级之间进行归并排序操作，同时需要常常进行数据压缩(Compaction)。</li>
</ul>
<h5 id="read-amplification">Read Amplification</h5>
<ul>
<li>由于 LSM 树的原因，读数据时往往需要在多个层级进行检索</li>
<li>读取数据时，往往不仅需要读取该 Key 所对应的数据所在的数据块，还要读取对应的索引块和 Bloom Filter 块，索引块和 Bloom Filter块的数据和可能比 KV 本身大得多。</li>
</ul>
<h3 id="persistent-memory-2">Persistent Memory</h3>
<h4 id="特性">特性</h4>
<ul>
<li>非易失，字节寻址</li>
<li>PM 将通过内存总线进行连接，而不是块接口，所以针对PM的原子写操作应该为8byte大小，相比于传统的存储设备较小。</li>
<li>为了保证一致性，需要保证内存操作的顺序</li>
</ul>
<h4 id="一致性保证-2">一致性保证</h4>
<ul>
<li>为了让内存的带宽最大化，现代的处理器可能会将内存写操作进行指令重排序。所以为了保证内存中的有序写，可能需要显式地使用如 CFLUSH 和 MFENCE等缓存刷新和内存隔离指令。</li>
<li>针对一些在 PM 上的写操作，如果数据量超过了 8bytes，在系统故障的情况下可能出现数据部分更新成功的情况，因为 PM 只保证 8bytes 的原子性，为了解决这样的不一致问题，考虑使用日志或者 CoW（Copy on Write）等技术来解决。</li>
</ul>
<h3 id="基于-lsm-树的优化">基于 LSM 树的优化</h3>
<h4 id="提高并行性">提高并行性</h4>
<ul>
<li>RockesDB(Facebook)：利用数据的特性（无重复Key），进行多线程压缩</li>
<li>HyperLevelDB：通过更为细致的锁管理机制增加了写线程的并行性。</li>
</ul>
<h4 id="减小写放大">减小写放大</h4>
<ul>
<li>PebblesDB (SOSP'17)：借鉴跳表的思想，弱化全局有序的约束，将每一层进行分段，段之间保证有序，段内无序。</li>
</ul>
<h4 id="基于硬件的优化ssd">基于硬件的优化（SSD）</h4>
<ul>
<li>VT-Tree (FAST'13)</li>
<li>WiscKey (FAST'16)：在 LSM-Tree 上做 Key 和 Value 的分离存储</li>
</ul>
<h2 id="single-level-merge-db">Single-Level Merge DB</h2>
<figure data-type="image" tabindex="1"><img src="https://github.com/zjs1224522500/files-and-images/blob/master/blog/pic/Arch-SLM-DB.png?raw=true" alt="image" loading="lazy"></figure>
<h3 id="主要贡献">主要贡献</h3>
<ul>
<li>使用 PM 存储 MemTable、Immutable MemTable 来提高更强的一致性保证，同时减小一致性的开销</li>
<li>在 PM 中引入 B+-Tree 作为索引，提高查询速度</li>
<li>将磁盘中的多级数据结构转为单级数据结构，并设计了一种选择性压缩机制</li>
</ul>
<h3 id="persistent-memtable">Persistent MemTable</h3>
<figure data-type="image" tabindex="2"><img src="https://github.com/zjs1224522500/files-and-images/blob/master/blog/pic/papers/slmdb-inert-pm.png?raw=true" alt="image" loading="lazy"></figure>
<ul>
<li>MemTable 的核心数据结构为 <strong>跳表 SkipList</strong></li>
<li>跳表的操作，如插入、更新、删除均可用 8bytes 的原子操作完成</li>
<li>采用 PM 存储 MemTable，不再需要 WAL 来保证一致性</li>
<li>针对跳表的索引部分不需要提供一致性保证，因为可以从原始数据中快速重建</li>
</ul>
<h4 id="insert">Insert</h4>
<ul>
<li>Insert(key, value, prevNode)</li>
</ul>
<pre><code>1: curNode := NewNode(key, value); // Create Node
2: curNode.next := prevNode.next;  // Modify currentNode.next pointer
3: mfence();                       // 插入内存屏障（读屏障），让高速缓存中的数据失效，重新从主内存加载数据
4: clflush(curNode);               // 缓存刷新， 持久化 currentNode 数据
5: mfence();                       // 插入内存屏障（写屏障），内存隔离，让写入缓存的最新数据写回到主内存
6: prevNode.next := curNode;       // Modify preNode.next pointer
7: mfence();                       // 插入内存屏障（读屏障），让高速缓存中的数据失效，重新从主内存加载数据
8: clflush(prevNode.next);         // 缓存刷新，持久化 preNode 的修改
9: mfence();                       // 插入内存屏障（写屏障），内存隔离，让写入缓存的最新数据写回到主内存
</code></pre>
<h5 id="延申链接">延申链接</h5>
<ul>
<li><a href="https://www.cnblogs.com/nju-lfk/p/8807860.html">[1] 博客园：内存屏障</a></li>
</ul>
<h3 id="b-tree-index-in-pm">B+-Tree Index in PM</h3>
<h4 id="when-to-build-the-tree-and-some-key-info">When to Build the Tree And Some Key Info</h4>
<ul>
<li>当把 KV 键值对从 Immutable MemTable 中往 SSTable 中刷入时，把 Key 相关的索引信息插入到 B+ 树中，作为叶子节点。</li>
<li>叶子节点包含的信息有：SSTable File 的标识符，文件内部对应的该 Key 的块的偏移量 和 数据块的大小。</li>
<li>B+ Tree 的更新操作：更新已有的 KV 对时，首先创建对应该 Key 的索引对象，然后修改原有的在 B+ 树中的指针，指向新的索引对象。旧的索引信息将会被视为垃圾数据进行统一的垃圾回收。</li>
<li>B+ Tree 的删除操作：当需要删除指定 Key 的数据时，则将该 Key 在 B+ 树中对应的索引信息删除。</li>
<li>垃圾回收时使用 PM 管理器如 PMDK 来进行垃圾回收。</li>
</ul>
<h4 id="build-the-tree">Build the Tree</h4>
<ul>
<li>当 KV 从 Immutable MemTable 中往 SSTable 刷入时（即 Flush操作），SLD-DB 创建两个后台线程：一个线程用于创建新的 SSTable File，一个用于向 B+ 树中插入索引信息。</li>
</ul>
<h5 id="file-creation-thread">File Creation Thread</h5>
<ul>
<li>该线程创建一个新的 SSTable 文件，把 Immutable MemTable 中的数据（K-V）写入到该文件中。</li>
<li>将该文件执行文件系统相关同步操作，如 fsync，同步到磁盘</li>
<li>同步之后，该线程将刚刚存储的 KV 对添加到一个队列中。（由向 B+ 树插入索引的线程创建的队列）</li>
</ul>
<h5 id="b-tree-insertion-thread">B+ Tree insertion thread</h5>
<ul>
<li>创建相应的 KV 索引信息队列</li>
<li>待数据写入线程将该队列填入数据之后，依次处理队列中的每个数据，构建 B+ 树</li>
</ul>
<h5 id="一致性保证-3">一致性保证</h5>
<ul>
<li>待 B+ Tree构建完成以后，将 LSM 树中组织结构的变化（例如 SSTable File 的元数据信息）以追加写的方式写入到 MANIFEST 文件中</li>
</ul>
<h5 id="其他">其他</h5>
<ul>
<li>待完成一致性的日志追加写操作之后，对应的删除PM中的 Immutable Memtable.</li>
</ul>
<h4 id="scanning-a-b-tree">Scanning a B+-tree</h4>
<ul>
<li>SLM-DB 提供了一个迭代器，主要用于扫描存储在磁盘中的 KV 键值对。支持 seek()、value()、next()等操作。
<ul>
<li>seek(k)：让迭代器指向 key 为 k 的键值对或者当 k 不存在时，指向比 k 稍大的 Key</li>
<li>next()：将迭代器指针移动到下一个 Key</li>
<li>value()：返回该 Key 对应的值</li>
</ul>
</li>
<li>在 SLM-DB 中，实现了 B+ Tree 的迭代器，主要用于扫描存储在 SSTables 中的 Key。</li>
</ul>
<h3 id="selective-compaction-选择性压缩">Selective Compaction 选择性压缩</h3>
<h4 id="why-need-compaction">Why need Compaction?</h4>
<ul>
<li>为了回收部分旧数据。（旧数据是由 Update 操作产生的，更新 Key 对应的值时，之前存储的该 Key 的数据就变成了老数据）</li>
<li>提升存储在 SSTables 中的 KV 键值对的顺序性，从而提升 Range Query的性能，以免要查询的 Key 分布散落在多个 SSTable File上</li>
</ul>
<h4 id="what-is-selective-compaction">What is Selective Compaction?</h4>
<ul>
<li>有选择性地选出一些 SSTables 进行压缩</li>
<li>SLM-DB 维护一个 候选压缩对象列表。（候选对象为具有一定特性的 SSTables）</li>
</ul>
<h4 id="when-execute">When execute?</h4>
<ul>
<li>通过启动一个后台的压缩线程来执行：
<ul>
<li>当 SSTable Files的一些结构性数据发生变化时</li>
<li>针对一个确定的 SSTable File 出现了多次 seek 操作时</li>
<li>当压缩对象候选列表里的文件数量大于一定的阈值时</li>
</ul>
</li>
<li>执行时，从候选列表中根据一定的计算规则选出子集进行压缩。该规则主要是计算 SSTable Files 之间的重叠率，通过计算出和候选列表中的其他 SSTable Files 重叠率最高的 SSTable Files，然后进行压缩合并。</li>
</ul>
<h4 id="how-to-compact">How to compact?</h4>
<ul>
<li>同上文一样使用两个线程，一个用于文件创建，一个用于索引的插入。</li>
<li>合并多个 SSTable Files时，需要检查该文件中的每一个键值对是有效数据还是老旧数据。通过查询 B+树中的索引信息来决定是否有效。如果有效，则需要和其他有效的数据进行归并排序，如果是老旧的数据则对应将其删除。</li>
</ul>
<h4 id="how-to-select">How to select?</h4>
<ul>
<li>SLM-DB 实现了三种选择算法：
<ul>
<li>Live-Key Ratio Select：有效 Key 比例选择</li>
<li>Leaf Node Scan：B+树叶子节点扫描选择</li>
<li>Degree of Sequentially per range query：根据顺序程度进行选择</li>
</ul>
</li>
</ul>
<h5 id="live-key-ratio-select">Live-Key Ratio Select</h5>
<ul>
<li>SLM-DB 统计每个 SSTable File 的有效 Key 比例，并且设定一个阈值，一旦比例低于该阈值，就会被添加到候选压缩对象列表中。</li>
<li>Live-Key Ratio 是指每个 SSTable File 中有效 Key 的比例。有效 Key 是指仍然维护在 B+ Tree 中的 Key，也就是仍为该 Key 对应的最新值。</li>
</ul>
<h5 id="leaf-node-scan">Leaf Node Scan</h5>
<ul>
<li>在执行压缩时，将触发一次 B+ Tree 叶子节点的扫描操作，通过循环扫描的方式，统计出存储了 B+ Tree 上有指定 Key 所对应的 SSTable Files 的文件数量，如果文件数量大于阈值，将这些文件添加到候选队列中进行压缩。</li>
<li>文件数量意味着在 LSM 结构中存在多个数据文件存储旧值。</li>
</ul>
<h5 id="degree-of-sequentially-per-range">Degree of Sequentially per range</h5>
<ul>
<li>将 range 操作拆分为多个 子范围查询操作，每个子范围查询对应的 Key 数量相等，然后追踪每个子范围查询访问的 SSTable File 的数量，一旦操作完成，找到访问最多文件的子范围查询，如果对应的文件数大于阈值，把这些对应的文件添加到候选人队列中等待压缩。</li>
<li>该方法主要是为了提高数据分布式的顺序性。</li>
</ul>
<h2 id="存在的问题">存在的问题？</h2>
<h3 id="1-b-树的引入带来的写放大问题何如">1. B+ 树的引入带来的写放大问题何如？</h3>
<h3 id="2-b-树索引结构的维护的一致性如何保证">2. B+ 树索引结构的维护的一致性如何保证？</h3>
<h3 id="3-针对大量小写的情况b-树是否会成为对应的性能瓶颈">3. 针对大量小写的情况，B+ 树是否会成为对应的性能瓶颈？</h3>
<h2 id="论文延申">论文延申</h2>
<h3 id="bloom-filter-布隆过滤器">Bloom Filter 布隆过滤器</h3>
<ul>
<li>本质上布隆过滤器是一种数据结构，比较巧妙的概率型数据结构（probabilistic data structure），特点是高效地插入和查询，可以用来告诉你 “某样东西一定不存在或者可能存在”。</li>
</ul>
<h4 id="特点">特点</h4>
<ul>
<li>相比于传统的 List、Set、Map 等数据结构，它更高效、占用空间更少，但是缺点是其返回的结果是概率性的，而不是确切的。</li>
<li>如果布隆过滤器判断的结果为不存在，那么事实上一定不存在；但如果布隆过滤器判断的结果为存在，那么事实上不一定存在。</li>
</ul>
<h4 id="原理">原理</h4>
<ul>
<li>数据结构：bit 向量/数组（初始化全为0）</li>
<li>支持的操作：添加（add）、判断是否存在（ifExsit）</li>
<li>不支持的操作：删除（delete）</li>
</ul>
<h5 id="添加操作">添加操作</h5>
<ul>
<li>使用多个 Hash 函数将要添加的值进行 Hash，得到多个对应的结果，将 bit 向量上的对应位置置为1。</li>
<li>每一次新的值都进行相同的操作，将对应位置置为0，但可能置0的位置已经为0了，所以仍然保持为1。</li>
</ul>
<h5 id="判断操作">判断操作</h5>
<ul>
<li>判断某个值是否已经存在，利用设定好的 Hash 函数对应的求出相应的 Hash 值，看这多个值对应的 bit 向量上是否全为1。如果不全为1，则一定不存在；如果全为1，则可能存在。（原因：不同的值可能产生哈希冲突同时使得某个位置上的值为1）</li>
</ul>
<h5 id="如何支持删除操作是个可以研究的问题">如何支持删除操作？(是个可以研究的问题)</h5>
<ul>
<li>对应的对每一位 bit 进行计数，采用计数删除的方式。但对应的会给每一位增加一个数值的开销。</li>
<li>然而要保证安全地删除元素并非如此简单。首先我们必须保证删除的元素的确在布隆过滤器里面。这一点单凭这个过滤器是无法保证的。另外计数器回绕也会造成问题。</li>
</ul>
<h4 id="如何选择哈希函数个数-k-和布隆过滤器长度-m">如何选择哈希函数个数 k 和布隆过滤器长度 m</h4>
<ul>
<li>k 次哈希函数某一 bit 位未被置为 1 的概率为：</li>
</ul>
<pre><code class="language-math">(1 - \frac {1}{m})^k
</code></pre>
<ul>
<li>插入n个元素后依旧为 1 的概率：</li>
</ul>
<pre><code class="language-math">1 - (1 - \frac {1}{m})^{kn}
</code></pre>
<ul>
<li>标明某个元素是否在集合中所需的 k 个位置都按照如上的方法设置为 1，但是该方法可能会使算法错误的认为某一原本不在集合中的元素却被检测为在该集合中（False Positives）</li>
</ul>
<pre><code class="language-math">(1 - (1 - \frac {1}{m})^{kn})^k \approx (1 - e^{-kn/m})^k
</code></pre>
<ul>
<li>选择合适的 k 和 m：n 为插入的元素个数，p 为误报率</li>
</ul>
<pre><code class="language-math">m = - n\ln p / (\ln 2)^2
</code></pre>
<pre><code class="language-math">k = \frac {m}{n} \ln2
</code></pre>
<h4 id="参考链接">参考链接</h4>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/43263751">[1] 知乎：详解布隆过滤器的原理，使用场景和注意事项</a></li>
<li><a href="https://www.cnblogs.com/CodeBear/p/10911177.html">[2] CodeBear的园子：大白话布隆过滤器</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%91%98%E8%A6%81">摘要</a></li>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#b-tree">B-Tree</a></li>
<li><a href="#lsm-tree">LSM Tree</a></li>
<li><a href="#persistent-memory">Persistent Memory</a></li>
<li><a href="#%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F">优化方式</a>
<ul>
<li><a href="#%E8%AF%BB%E4%BC%98%E5%8C%96">读优化</a></li>
<li><a href="#%E5%86%99%E4%BC%98%E5%8C%96">写优化</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#background-motivation">Background &amp; Motivation</a>
<ul>
<li><a href="#leveldb-introduction">LevelDB Introduction</a>
<ul>
<li><a href="#%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86">组成部分</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6">核心机制</a>
<ul>
<li><a href="#%E5%86%99%E6%B5%81%E7%A8%8B">写流程</a></li>
<li><a href="#%E8%AF%BB%E6%B5%81%E7%A8%8B">读流程</a></li>
</ul>
</li>
<li><a href="#%E4%B8%80%E8%87%B4%E6%80%A7%E4%BF%9D%E8%AF%81">一致性保证</a></li>
<li><a href="#%E5%BB%B6%E7%94%B3%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">延申参考链接</a></li>
</ul>
</li>
<li><a href="#limitation-of-leveldb">Limitation of LevelDB</a>
<ul>
<li><a href="#slow-read-operation">Slow Read Operation</a></li>
<li><a href="#high-write-and-read-amplification">High write and read amplification</a>
<ul>
<li><a href="#write-amplification">Write Amplification</a></li>
<li><a href="#read-amplification">Read Amplification</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#persistent-memory-2">Persistent Memory</a>
<ul>
<li><a href="#%E7%89%B9%E6%80%A7">特性</a></li>
<li><a href="#%E4%B8%80%E8%87%B4%E6%80%A7%E4%BF%9D%E8%AF%81-2">一致性保证</a></li>
</ul>
</li>
<li><a href="#%E5%9F%BA%E4%BA%8E-lsm-%E6%A0%91%E7%9A%84%E4%BC%98%E5%8C%96">基于 LSM 树的优化</a>
<ul>
<li><a href="#%E6%8F%90%E9%AB%98%E5%B9%B6%E8%A1%8C%E6%80%A7">提高并行性</a></li>
<li><a href="#%E5%87%8F%E5%B0%8F%E5%86%99%E6%94%BE%E5%A4%A7">减小写放大</a></li>
<li><a href="#%E5%9F%BA%E4%BA%8E%E7%A1%AC%E4%BB%B6%E7%9A%84%E4%BC%98%E5%8C%96ssd">基于硬件的优化（SSD）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#single-level-merge-db">Single-Level Merge DB</a>
<ul>
<li><a href="#%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE">主要贡献</a></li>
<li><a href="#persistent-memtable">Persistent MemTable</a>
<ul>
<li><a href="#insert">Insert</a>
<ul>
<li><a href="#%E5%BB%B6%E7%94%B3%E9%93%BE%E6%8E%A5">延申链接</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#b-tree-index-in-pm">B+-Tree Index in PM</a>
<ul>
<li><a href="#when-to-build-the-tree-and-some-key-info">When to Build the Tree And Some Key Info</a></li>
<li><a href="#build-the-tree">Build the Tree</a>
<ul>
<li><a href="#file-creation-thread">File Creation Thread</a></li>
<li><a href="#b-tree-insertion-thread">B+ Tree insertion thread</a></li>
<li><a href="#%E4%B8%80%E8%87%B4%E6%80%A7%E4%BF%9D%E8%AF%81-3">一致性保证</a></li>
<li><a href="#%E5%85%B6%E4%BB%96">其他</a></li>
</ul>
</li>
<li><a href="#scanning-a-b-tree">Scanning a B+-tree</a></li>
</ul>
</li>
<li><a href="#selective-compaction-%E9%80%89%E6%8B%A9%E6%80%A7%E5%8E%8B%E7%BC%A9">Selective Compaction 选择性压缩</a>
<ul>
<li><a href="#why-need-compaction">Why need Compaction?</a></li>
<li><a href="#what-is-selective-compaction">What is Selective Compaction?</a></li>
<li><a href="#when-execute">When execute?</a></li>
<li><a href="#how-to-compact">How to compact?</a></li>
<li><a href="#how-to-select">How to select?</a>
<ul>
<li><a href="#live-key-ratio-select">Live-Key Ratio Select</a></li>
<li><a href="#leaf-node-scan">Leaf Node Scan</a></li>
<li><a href="#degree-of-sequentially-per-range">Degree of Sequentially per range</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">存在的问题？</a>
<ul>
<li><a href="#1-b-%E6%A0%91%E7%9A%84%E5%BC%95%E5%85%A5%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%86%99%E6%94%BE%E5%A4%A7%E9%97%AE%E9%A2%98%E4%BD%95%E5%A6%82">1. B+ 树的引入带来的写放大问题何如？</a></li>
<li><a href="#2-b-%E6%A0%91%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84%E7%9A%84%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81">2. B+ 树索引结构的维护的一致性如何保证？</a></li>
<li><a href="#3-%E9%92%88%E5%AF%B9%E5%A4%A7%E9%87%8F%E5%B0%8F%E5%86%99%E7%9A%84%E6%83%85%E5%86%B5b-%E6%A0%91%E6%98%AF%E5%90%A6%E4%BC%9A%E6%88%90%E4%B8%BA%E5%AF%B9%E5%BA%94%E7%9A%84%E6%80%A7%E8%83%BD%E7%93%B6%E9%A2%88">3. 针对大量小写的情况，B+ 树是否会成为对应的性能瓶颈？</a></li>
</ul>
</li>
<li><a href="#%E8%AE%BA%E6%96%87%E5%BB%B6%E7%94%B3">论文延申</a>
<ul>
<li><a href="#bloom-filter-%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8">Bloom Filter 布隆过滤器</a>
<ul>
<li><a href="#%E7%89%B9%E7%82%B9">特点</a></li>
<li><a href="#%E5%8E%9F%E7%90%86">原理</a>
<ul>
<li><a href="#%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C">添加操作</a></li>
<li><a href="#%E5%88%A4%E6%96%AD%E6%93%8D%E4%BD%9C">判断操作</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E6%94%AF%E6%8C%81%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C%E6%98%AF%E4%B8%AA%E5%8F%AF%E4%BB%A5%E7%A0%94%E7%A9%B6%E7%9A%84%E9%97%AE%E9%A2%98">如何支持删除操作？(是个可以研究的问题)</a></li>
</ul>
</li>
<li><a href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E4%B8%AA%E6%95%B0-k-%E5%92%8C%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%E9%95%BF%E5%BA%A6-m">如何选择哈希函数个数 k 和布隆过滤器长度 m</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>Elvis Zhang</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://blog.shunzi.tech/post/slm-db-single-level-key-value-store-with-persistent-memory/">https://blog.shunzi.tech/post/slm-db-single-level-key-value-store-with-persistent-memory/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://blog.shunzi.tech/post/slm-db-single-level-key-value-store-with-persistent-memory/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://blog.shunzi.tech/post/slm-db-single-level-key-value-store-with-persistent-memory/&sharesource=qzone&title=SLM-DB Single-Level Key-Value Store with Persistent Memory&pics=https://blog.shunzi.tech/images/avatar.png?v=1623475546024&summary=&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;FAST 2019 的文章《SLM-DB Single-Level Key-Value Store with Persistent Memory》&lt;/li&gt;
&lt;li&gt;这篇论文主要在新型存储器件Persistent Memory上针对传统的 LSM 树进行了优化。&lt;/li&gt;
&lt;li&gt;本篇论文用于课程论文阅读汇报，故在此总结便于演讲。同时学习 NVM 相关基础知识。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
"><i class="fa fa-qq"></i></a>
                                                                    <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://blog.shunzi.tech/post/slm-db-single-level-key-value-store-with-persistent-memory/&sharesource=weibo&title=SLM-DB Single-Level Key-Value Store with Persistent Memory + " - " + &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;FAST 2019 的文章《SLM-DB Single-Level Key-Value Store with Persistent Memory》&lt;/li&gt;
&lt;li&gt;这篇论文主要在新型存储器件Persistent Memory上针对传统的 LSM 树进行了优化。&lt;/li&gt;
&lt;li&gt;本篇论文用于课程论文阅读汇报，故在此总结便于演讲。同时学习 NVM 相关基础知识。&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&pic="https://blog.shunzi.tech/images/avatar.png?v=1623475546024 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://blog.shunzi.tech/tag/5uQUdLlSC/">#
                    Paper
                        </a>
                        
                        <a href="https://blog.shunzi.tech/tag/3zCwFWPHxH/">#
                    存储
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://blog.shunzi.tech/post/file-systems-unit-as-distributed-storagelessons-from-10-years-of-ceph-evolution/">
                                                                                            File Systems Unit as Distributed Storage:Lessons from 10 Years of Ceph Evolution
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://blog.shunzi.tech/post/exploiting-commutativity-for-practical-fast-replication/">
                                                                                                    Exploiting Commutativity For Practical Fast Replication
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                                            
                                                <script type="application/javascript" src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
<div id="vlaine-comment"></div>
<script type="application/javascript">
    new Valine({
        el: '#vlaine-comment',
        appId: 'Pj5H1z0w7hJlLGJpGBh9NrCq-MdYXbMMI',
        appKey: 'LdR8vK5EaBfK87esF7tlbsXe',
        pageSize: 5,
        avatar: 'mp',
        placeholder: '来都来了，不妨评论一下',
        visitor: false,
        highlight: false,
        recordIP: false,
    })
</script>
                                                    
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
                            
                                <b id="hitokoto"></b><br>
                                
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        Elvis Zhang &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://github.com/" target="_blank">
                                                Github Pages
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.6
                </div>
                
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    
                    
                    loadlive2d();
                    
                    
                    hitokoto();
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1623475546024);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>